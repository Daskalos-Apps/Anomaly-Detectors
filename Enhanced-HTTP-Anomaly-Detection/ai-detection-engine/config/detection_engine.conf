# Enhanced Anomaly Detection Engine Configuration

[model]
# Model architecture (same as original)
architecture = 64-64-output
n_features = 31  # 21 network + 10 HTTP
n_classes = 2
learning_rate = 0.001
dropout_rate = 0.2
l2_regularization = 0.001

# Detection threshold
threshold = 0.4  # Optimized for low false negatives

[training]
epochs = 50
batch_size = 32
validation_split = 0.2
early_stopping_patience = 10
reduce_lr_patience = 5

[features]
# Network features (original)
network_features = [
    "flow_duration",
    "total_fwd_packets", 
    "total_bwd_packets",
    "fwd_packet_length_mean",
    "bwd_packet_length_mean",
    "flow_bytes_s",
    "flow_packets_s",
    "flow_iat_mean",
    "flow_iat_std",
    "fwd_iat_mean",
    "bwd_iat_mean",
    "fwd_psh_flags",
    "bwd_psh_flags",
    "fin_flag_count",
    "syn_flag_count",
    "rst_flag_count",
    "psh_flag_count",
    "ack_flag_count",
    "average_packet_size",
    "subflow_fwd_packets",
    "subflow_bwd_packets"
]

# HTTP features (enhanced)
http_features = [
    "request_complexity",
    "response_pattern",
    "path_entropy",
    "encoding_indicator",
    "scan_pattern",
    "brute_force_pattern",
    "injection_pattern",
    "xss_pattern",
    "automated_pattern",
    "suspicious_timing"
]

[preprocessing]
# Data preprocessing settings
handle_missing = true
handle_infinite = true
normalize = true
remove_outliers = false
outlier_threshold = 3.0

[logging]
level = INFO
file = /var/log/enhanced_detector.log
format = "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
console = true

[apache]
# Apache log parsing settings
log_format = combined  # combined, common, or custom
date_format = "%d/%b/%Y:%H:%M:%S %z"
encoding = utf-8
error_handling = ignore  # ignore, strict, or replace

[paths]
# File paths
model_dir = /models/enhanced
data_dir = /data
output_dir = /output
temp_dir = /tmp

[performance]
# Performance settings
chunk_size = 1000
max_workers = 4
cache_enabled = true
cache_size = 1000

[security]
# Security settings
validate_input = true
sanitize_paths = true
max_path_length = 2048
max_request_size = 10485760  # 10MB

[federation]
# Federated learning settings (for FL mode)
enabled = false
aggregator_url = http://localhost:5000
client_id = enhanced_node_01
communication_rounds = 100
local_epochs = 5

[monitoring]
# Monitoring and metrics
metrics_enabled = true
metrics_port = 9090
health_check_enabled = true
health_check_port = 8080

[alerts]
# Alert settings
enabled = false
webhook_url = ""
email_enabled = false
email_to = ""
email_from = ""
smtp_server = ""
smtp_port = 587

[database]
# Optional database for storing results
enabled = false
type = sqlite  # sqlite, mysql, postgresql
connection_string = "sqlite:///detection_results.db"

[api]
# API settings for serving predictions
enabled = false
host = 0.0.0.0
port = 8080
auth_enabled = false
api_key = ""
rate_limit = 100  # requests per minute

[advanced]
# Advanced settings
feature_importance = true
explainability = false
ensemble_enabled = false
ensemble_models = ["random_forest", "gradient_boost", "dnn"]